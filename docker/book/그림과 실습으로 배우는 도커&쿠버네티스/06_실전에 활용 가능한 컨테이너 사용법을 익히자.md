### 컨테이너와 호스트 간에 파일 복사하기
파일 복사는 컨테이너->호스트, 호스트->컨테이너로 양방향 모두 가능하다.  
- 호스트pc -> 컨테이너 복사
  - docker cp 호스트_경로 컨테이너명:컨테이너_경로
- 컨테이너 -> 호스트pc
  - docker cp 컨테이너명:컨테이너_경로 호스트_경로

### 볼륨 마운트
도커에서 스토리지 마운트는 두 가지 종류가 있다. 하나는 볼륨 마운트이고, 하나는 바인드 마운트이다.  
볼륨 마운트는 도커에서 관리하는 볼륨이다. 도커에서 볼륨 이름으로 관리하면 되기때문에 다루기 쉽지만 바인드 마운트에 비해 직접 조작하기 어려우므로 '임시 목적의 사용'이나 '자주 쓰지는 않지만 지우면 안 되는 파일'을 두는 목적으로 많이 사용한다.  

바인드 마운드는 호스트 PC에서 디렉토리를 생성하여 컨테이너에 마운트하는 방식이다. 디렉토리 속에 파일을 직접 두거나 열어 볼 수 있기 때문에 자주 사용하는 파일을 두는 데 사용한다.

[실습]  
- 바인드 마운트
```
mkdir apa_folder

docker run -d -p 8080:80 -v ./apa_folder:/usr/local/apache2/htdocs httpd

cd apa_folder
vi index.html
my_web
```
apa_folder 디렉토리 안에 index.html파일을 생성한 이후 웹 브라우저에 생성한 apache 컨테이너 접속  
http://15.164.232.179:8080/

- 볼륨 마운트
```
docker volume create apa_folder

docker run -d -p 8080:80 -v apa_folder:/usr/local/apache2/htdocs httpd
```

[백업]
바인드 마운트 같은 경우에는 폴더 자체를 복사하면 백업할 수 있으나 볼륨 마운트같은 경우에는 Linux 컨테이너를 하나 생성하여 백업해야된다.  
볼륨 마운트 작업을 1.백업할 볼륨->저장 폴더 2.저장 폴더->백업할 폴더 위치로 2번하여 백업한다.
```
docker run --rm -v 볼륨명:/source -v 백업_저장_폴더명:/target busybox tar cvzf /target/백업파일이름.tar.gz -C /source
```

### 이미지 만드는 방법
1. Docker Hub에서 이미지 pull
2. commit 커맨드로 컨테이너를 이미지로 변환
3. Dockerfile 생성

1. Docker Hub에서 이미지 pull
```
docker pull 이미지_이름:버전
```
2. commit 커맨드로 컨테이너를 이미지로 변환
실행중인 컨테이너를 commit 커맨드를 통해 이미지로 만들 수 있다.  
컨테이너를 Base 이미지로 생성한 이후에 컨테이너에 접속하여 원하는 작업을 한 이후 commit 커맨드로 이미지로 만들면 작업한 내용들이 전부 이미지로 복사된다.
```
docker commit 컨테이너_이름 이미지_이름
```
3. Dockerfile 생성
```
docker build -t 생성할_이미지_이름 
```
- Dockerfile 인스트럭션
|인스트럭션|내용|
|------|---|
|FROM|토대가 되는 이미지를 지정|
|ADD|이미지에 파일이나 폴더 추가|
|COPY|이미지에 파일이나 폴더 추가|
|RUN|이미지를 빌드할 때 실행할 명령어를 지정|
|CMD|컨테이너를 실행할 때 실행할 명령어를 지정|
|ENTRYPOINT|컨테이너를 실행할 때 실행할 명령어를 강제 지정|
|ONBUILD|이 이미지를 기반으로 다른 이미지를 빌드할 때 실행할 명령어를 지정|
|EXPOSE|이미지가 통신에 사용할 포트를 명시적으로 지정|
|VOLUME|퍼스턴시 데이터를 지정할 경로를 명시적으로 지정|
|ENV|환경변수를 정의|
|WORKDIR|작업 디렉토리 지정|
|SHELL|빌드시 사용할 셀을 변경|
|LABEL|이미지에 파일이나 폴더 추가|
|USER|RUN, CMD, ETRYPOINT에 정의된 명령어를 실행하는 사용자 또는 그룹 지정|
|ADD|이미지에 파일이나 폴더 추가|
|ARG|docker build 커맨드를 사용할 때 입력받을 수 있는 인자를 선언|
|STOPSIGNAL|docker stop 커맨드를 사용할 때 컨테이넌 안에서 실행중인 프로그램에 전달되는 시그널을 변경|
|HEALTHCHECK|컨테이너 헬스체크 방법을 커스터마이징|

### 도커 허브와 도커 레지스트리
이미지를 배포하는 장소를 '도커 레지스트리'라고 한다.  
도커 허브는 도커 제작사에서 운영하는 공식 도커 레지스트리이다.  

### 레지스트리와 리포지토리
레지스트리는 이미지를 배포하는 장소이고, 리포지토리는 레지스트리를 구성하는 단위이다.  
예를 들어, 'A'라는 회사에 'a' 서비스와 'b'서비스가 있다면 레지스트리는 'A'가 될 것 이고, 'a'와 'b' 서비스는 각각 리포지토리가 될 것이다.  
레지스트리가 더 큰 단위라고 생각하면 된다.  

### 이미지와 태그
도커 레포지토리에 업로드를 하려면 이미지의 태그를 부여해야한다.  
|레지스트리의 태그|레지스트리_주소/리포지토리_이름:버전|
|------|---|
|레포지토리 도메인은 zoozoo.com, 리포지토리 이름은 my_repo, ver12|zoozoo.com/my_repo:12|
|도커 허브ID는 garnett, 리포지토리 이름은 my_repo, ver12|garnett/my_repo:12|